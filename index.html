<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Marcio Ramos Im√≥veis - Sua Imobili√°ria Digital</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" id="pageDescription" content="Encontre os melhores im√≥veis com Marcio Ramos, corretor especialista h√° 15 anos. Casas, apartamentos, terrenos para compra, venda e aluguel.">
    <meta name="keywords" content="im√≥veis, corretor, casas, apartamentos, terrenos, compra, venda, aluguel, Marcio Ramos, imobili√°ria">
    <meta name="author" content="Marcio Ramos Im√≥veis">
    <meta name="robots" content="index, follow">
    <link rel="canonical" id="canonical" href="https://marcioramosimoveis.com.br">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" id="ogUrl" content="https://marcioramosimoveis.com.br">
    <meta property="og:title" id="ogTitle" content="Marcio Ramos Im√≥veis - Sua Imobili√°ria Digital">
    <meta property="og:description" id="ogDescription" content="Encontre os melhores im√≥veis com Marcio Ramos, corretor especialista h√° 15 anos.">
    <meta property="og:image" content="https://marcioramosimoveis.com.br/og-image.jpg">
    <meta property="og:site_name" content="Marcio Ramos Im√≥veis">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" id="twitterUrl" content="https://marcioramosimoveis.com.br">
    <meta property="twitter:title" id="twitterTitle" content="Marcio Ramos Im√≥veis - Sua Imobili√°ria Digital">
    <meta property="twitter:description" id="twitterDescription" content="Encontre os melhores im√≥veis com Marcio Ramos, corretor especialista h√° 15 anos.">
    <meta property="twitter:image" content="https://marcioramosimoveis.com.br/og-image.jpg">
    
    <!-- Structured Data -->
    <script type="application/ld+json" id="structuredData">
    {
      "@context": "https://schema.org",
      "@type": "RealEstateAgent",
      "name": "Marcio Ramos Im√≥veis",
      "description": "Corretor de im√≥veis especialista h√° mais de 15 anos",
      "url": "https://marcioramosimoveis.com.br",
      "telephone": "+55-11-99999-9999",
      "email": "marcio@marcioramosimoveis.com.br",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Rua das Flores, 123",
        "addressLocality": "S√£o Paulo",
        "addressRegion": "SP",
        "postalCode": "01000-000",
        "addressCountry": "BR"
      },
      "sameAs": [
        "https://www.facebook.com/marcioramosimoveis",
        "https://www.instagram.com/marcioramosimoveis"
      ]
    }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Meta Pixel (Facebook) - Conditional Loading -->
    <script>
    // Fun√ß√£o para instalar Meta Pixel
    function installMetaPixel(pixelId) {
        if (typeof fbq !== 'undefined') return; // J√° instalado
        
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        
        fbq('init', pixelId);
        fbq('track', 'PageView');
        
        // Adicionar noscript
        const noscript = document.createElement('noscript');
        noscript.innerHTML = `<img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=${pixelId}&ev=PageView&noscript=1" />`;
        document.head.appendChild(noscript);
        
        console.log('Meta Pixel instalado com ID:', pixelId);
    }
    
    // Instalar automaticamente se houver ID configurado
    const metaPixelId = localStorage.getItem('metaPixelId');
    if (metaPixelId && metaPixelId !== 'SEU_PIXEL_ID_AQUI') {
        installMetaPixel(metaPixelId);
    }
    </script>
    
    <!-- Google Analytics 4 - Conditional Loading -->
    <script>
    // Fun√ß√£o para instalar Google Analytics
    function installGoogleAnalytics(measurementId) {
        if (typeof gtag !== 'undefined') return; // J√° instalado
        
        const script = document.createElement('script');
        script.async = true;
        script.src = `https://www.googletagmanager.com/gtag/js?id=${measurementId}`;
        document.head.appendChild(script);
        
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        window.gtag = gtag;
        gtag('js', new Date());
        gtag('config', measurementId);
        
        console.log('Google Analytics instalado com ID:', measurementId);
    }
    
    // Instalar automaticamente se houver ID configurado
    const gaId = localStorage.getItem('googleAnalyticsId');
    if (gaId && gaId !== 'GA_MEASUREMENT_ID') {
        installGoogleAnalytics(gaId);
    }
    </script>
    
    <!-- Google Tag Manager - Conditional Loading -->
    <script>
    // Fun√ß√£o para instalar Google Tag Manager
    function installGoogleTagManager(gtmId) {
        if (window.dataLayer && window.dataLayer.find(item => item['gtm.start'])) return; // J√° instalado
        
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer',gtmId);
        
        // Adicionar noscript
        const noscript = document.createElement('noscript');
        noscript.innerHTML = `<iframe src="https://www.googletagmanager.com/ns.html?id=${gtmId}" height="0" width="0" style="display:none;visibility:hidden"></iframe>`;
        document.body.insertBefore(noscript, document.body.firstChild);
        
        console.log('Google Tag Manager instalado com ID:', gtmId);
    }
    
    // Instalar automaticamente se houver ID configurado
    const gtmId = localStorage.getItem('googleTagManagerId');
    if (gtmId && gtmId !== 'GTM-XXXXXXX') {
        installGoogleTagManager(gtmId);
    }
    </script>
    
    <style>
        .property-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .property-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .gallery-image {
            transition: transform 0.3s ease;
        }
        .gallery-image:hover {
            transform: scale(1.05);
        }
        .modal {
            backdrop-filter: blur(5px);
        }
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .feature-icon {
            transition: transform 0.3s ease;
        }
        .feature-icon:hover {
            transform: scale(1.1);
        }
        .dropdown:hover .dropdown-menu {
            display: block;
        }
        .hero-section {
            height: 450px;
        }
        .image-gallery {
            position: relative;
        }
        .gallery-main-image {
            transition: opacity 0.3s ease;
        }
        .gallery-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
            z-index: 10;
        }
        .gallery-nav-btn:hover {
            background: rgba(0, 0, 0, 0.7);
        }
        .gallery-nav-btn.prev {
            left: 10px;
        }
        .gallery-nav-btn.next {
            right: 10px;
        }
        .gallery-thumbnail {
            cursor: pointer;
            transition: opacity 0.3s ease, transform 0.3s ease;
            border: 2px solid transparent;
        }
        .gallery-thumbnail:hover {
            transform: scale(1.05);
        }
        .gallery-thumbnail.active {
            border-color: #3b82f6;
            opacity: 1;
        }
        .gallery-thumbnail:not(.active) {
            opacity: 0.7;
        }
    </style>
</head>
<body class="bg-gray-50">


    <!-- Header -->
    <header class="bg-white shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4 py-3 sm:py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-2 sm:space-x-3">
                    <div class="w-10 h-10 sm:w-12 sm:h-12 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-lg sm:text-xl">üè†</span>
                    </div>
                    <div>
                        <h1 class="text-lg sm:text-2xl font-bold text-gray-800">Marcio Ramos</h1>
                        <p class="text-xs sm:text-sm text-gray-600">Im√≥veis</p>
                    </div>
                </div>
                <nav class="hidden md:flex items-center space-x-4 lg:space-x-6 xl:space-x-8">
                    <a href="#home" class="text-gray-700 hover:text-blue-600 transition-colors text-sm lg:text-base">In√≠cio</a>
                    <div class="dropdown relative">
                        <a href="#properties" class="text-gray-700 hover:text-blue-600 transition-colors cursor-pointer text-sm lg:text-base">Im√≥veis ‚ñº</a>
                        <div class="dropdown-menu absolute top-full left-0 bg-white shadow-lg rounded-lg py-2 w-48 hidden z-50">
                            <a href="#" onclick="filterProperties('compra')" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 text-sm">Compra</a>
                            <a href="#" onclick="filterProperties('venda')" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 text-sm">Venda</a>
                            <a href="#" onclick="filterProperties('aluguel')" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 text-sm">Aluguel</a>
                        </div>
                    </div>
                    <a href="#about" class="text-gray-700 hover:text-blue-600 transition-colors text-sm lg:text-base">Sobre</a>
                    <a href="#contact" class="text-gray-700 hover:text-blue-600 transition-colors text-sm lg:text-base">Contato</a>
                    <button onclick="showAdminLogin()" class="text-gray-700 hover:text-blue-600 transition-colors text-sm lg:text-base">Admin</button>
                </nav>
                <button onclick="toggleMobileMenu()" class="md:hidden text-gray-700 p-2">
                    <svg id="menuIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                    <svg id="closeIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="md:hidden hidden mt-4 pb-4 border-t border-gray-200">
                <nav class="flex flex-col space-y-3 pt-4">
                    <a href="#home" onclick="closeMobileMenu()" class="text-gray-700 hover:text-blue-600 transition-colors py-2">In√≠cio</a>
                    <div class="border-l-2 border-gray-200 pl-4">
                        <p class="text-gray-600 font-medium mb-2">Im√≥veis</p>
                        <a href="#" onclick="filterProperties('compra'); closeMobileMenu();" class="block text-gray-600 hover:text-blue-600 py-1 text-sm">Compra</a>
                        <a href="#" onclick="filterProperties('venda'); closeMobileMenu();" class="block text-gray-600 hover:text-blue-600 py-1 text-sm">Venda</a>
                        <a href="#" onclick="filterProperties('aluguel'); closeMobileMenu();" class="block text-gray-600 hover:text-blue-600 py-1 text-sm">Aluguel</a>
                    </div>
                    <a href="#about" onclick="closeMobileMenu()" class="text-gray-700 hover:text-blue-600 transition-colors py-2">Sobre</a>
                    <a href="#contact" onclick="closeMobileMenu()" class="text-gray-700 hover:text-blue-600 transition-colors py-2">Contato</a>
                    <button onclick="showAdminLogin(); closeMobileMenu();" class="text-left text-gray-700 hover:text-blue-600 transition-colors py-2">Admin</button>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="home" class="hero-gradient text-white hero-section flex items-center">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold mb-2 sm:mb-3">Encontre Seu Lar Ideal</h2>
            <p class="text-base sm:text-lg lg:text-xl mb-3 sm:mb-4 max-w-2xl mx-auto px-4">Descubra os melhores im√≥veis com Marcio Ramos, seu corretor de confian√ßa h√° mais de 15 anos no mercado.</p>
            
            <!-- Search Form -->
            <div class="bg-white rounded-lg p-3 sm:p-4 max-w-5xl mx-auto shadow-xl">
                <div class="flex flex-col sm:flex-row gap-2 sm:gap-3">
                    <select id="propertyType" class="flex-1 p-2 sm:p-3 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-blue-500 text-xs sm:text-sm">
                        <option value="">Tipo</option>
                        <option value="casa">Casa</option>
                        <option value="apartamento">Apartamento</option>
                        <option value="terreno">Terreno</option>
                        <option value="comercial">Comercial</option>
                        <option value="chacara">Ch√°cara</option>
                        <option value="sobrado">Sobrado</option>
                    </select>
                    <select id="transactionType" class="flex-1 p-2 sm:p-3 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-blue-500 text-xs sm:text-sm">
                        <option value="">Transa√ß√£o</option>
                        <option value="compra">Compra</option>
                        <option value="aluguel">Aluguel</option>
                        <option value="venda">Venda</option>
                    </select>
                    <input type="text" id="priceRange" placeholder="Pre√ßo m√°x." class="flex-1 p-2 sm:p-3 border border-gray-300 rounded-lg text-gray-700 focus:ring-2 focus:ring-blue-500 text-xs sm:text-sm">
                    <button onclick="searchProperties()" class="bg-blue-600 hover:bg-blue-700 text-white p-2 sm:p-3 px-4 sm:px-6 rounded-lg font-semibold transition-colors text-xs sm:text-sm whitespace-nowrap">
                        üîç Buscar
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Properties Section -->
    <section id="properties" class="py-12 sm:py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <h3 class="text-2xl sm:text-3xl font-bold text-center mb-8 sm:mb-12 text-gray-800">Im√≥veis em Destaque</h3>
            <div id="propertiesGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8">
                <!-- Properties will be loaded here -->
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-12 sm:py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto text-center">
                <h3 class="text-2xl sm:text-3xl font-bold mb-6 sm:mb-8 text-gray-800">Sobre Marcio Ramos</h3>
                <p class="text-base sm:text-lg text-gray-600 mb-6 sm:mb-8 px-4">
                    Com mais de 15 anos de experi√™ncia no mercado imobili√°rio, Marcio Ramos se destaca pela excel√™ncia no atendimento e pelo conhecimento profundo do mercado local. Especialista em negocia√ß√µes e com vasta carteira de clientes satisfeitos.
                </p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 sm:gap-8 mt-8 sm:mt-12">
                    <div class="text-center p-4">
                        <div class="text-3xl sm:text-4xl font-bold text-blue-600 mb-2">800+</div>
                        <div class="text-sm sm:text-base text-gray-600">Im√≥veis Vendidos</div>
                    </div>
                    <div class="text-center p-4">
                        <div class="text-3xl sm:text-4xl font-bold text-blue-600 mb-2">1500+</div>
                        <div class="text-sm sm:text-base text-gray-600">Clientes Satisfeitos</div>
                    </div>
                    <div class="text-center p-4">
                        <div class="text-3xl sm:text-4xl font-bold text-blue-600 mb-2">15+</div>
                        <div class="text-sm sm:text-base text-gray-600">Anos de Experi√™ncia</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-12 sm:py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <h3 class="text-2xl sm:text-3xl font-bold text-center mb-8 sm:mb-12 text-gray-800">Entre em Contato</h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 sm:gap-12 max-w-6xl mx-auto">
                <div class="order-2 lg:order-1">
                    <h4 class="text-lg sm:text-xl font-semibold mb-4 sm:mb-6">Fale com Marcio Ramos</h4>
                    <div class="space-y-3 sm:space-y-4">
                        <div class="flex items-start space-x-3">
                            <span class="text-xl sm:text-2xl mt-1">üìç</span>
                            <span class="text-sm sm:text-base">Rua das Flores, 123 - Centro</span>
                        </div>
                        <div class="flex items-center space-x-3">
                            <span class="text-xl sm:text-2xl">üìû</span>
                            <a href="tel:+5511999999999" class="text-sm sm:text-base hover:text-blue-600 transition-colors">(11) 99999-9999</a>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="text-xl sm:text-2xl mt-1">‚úâÔ∏è</span>
                            <a href="mailto:marcio@marcioramosimoveis.com.br" class="text-sm sm:text-base hover:text-blue-600 transition-colors break-all">marcio@marcioramosimoveis.com.br</a>
                        </div>
                        <div class="flex items-start space-x-3">
                            <span class="text-xl sm:text-2xl mt-1">üïí</span>
                            <span class="text-sm sm:text-base">Segunda a S√°bado: 8h √†s 18h</span>
                        </div>
                    </div>
                </div>
                <div class="order-1 lg:order-2">
                    <form class="space-y-4" onsubmit="submitContact(event)">
                        <input type="text" placeholder="Seu nome" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm sm:text-base">
                        <input type="email" placeholder="Seu email" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm sm:text-base">
                        <input type="tel" placeholder="Seu telefone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm sm:text-base">
                        <textarea placeholder="Sua mensagem" rows="4" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm sm:text-base resize-none"></textarea>
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800">
                            <p class="font-medium">üìã Formul√°rio de Demonstra√ß√£o</p>
                            <p class="mt-1">Este √© um formul√°rio de exemplo. Para contato real, use o WhatsApp ou telefone ao lado.</p>
                        </div>
                        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition-colors text-sm sm:text-base">
                            üìß Enviar Mensagem (Demo)
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                            <span class="text-white font-bold">üè†</span>
                        </div>
                        <div>
                            <h5 class="text-xl font-bold">Marcio Ramos</h5>
                            <p class="text-sm text-gray-400">Im√≥veis</p>
                        </div>
                    </div>
                    <p class="text-gray-400">Seu corretor de confian√ßa.</p>
                </div>
                <div>
                    <h6 class="font-semibold mb-4">Servi√ßos</h6>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Compra</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Venda</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Loca√ß√£o</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Avalia√ß√£o</a></li>
                    </ul>
                </div>
                <div>
                    <h6 class="font-semibold mb-4">Tipos de Im√≥vel</h6>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Apartamentos</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Casas</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Terrenos</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Comercial</a></li>
                    </ul>
                </div>
                <div>
                    <h6 class="font-semibold mb-4">Redes Sociais</h6>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <span class="text-2xl">üìò</span>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <span class="text-2xl">üì∑</span>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <span class="text-2xl">üê¶</span>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2024 Marcio Ramos Im√≥veis. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- WhatsApp Floating Button -->
    <div id="whatsappButton" class="fixed bottom-4 right-4 sm:bottom-6 sm:right-6 z-50">
        <a href="https://wa.me/5511999999999?text=Ol√° Marcio! Vi um im√≥vel no site e gostaria de mais informa√ß√µes." 
           target="_blank" 
           onclick="trackWhatsAppClick()"
           class="bg-green-500 hover:bg-green-600 text-white rounded-full p-3 sm:p-4 shadow-lg transition-all duration-300 hover:scale-110 flex items-center justify-center">
            <svg class="w-6 h-6 sm:w-8 sm:h-8" fill="currentColor" viewBox="0 0 24 24">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.687"/>
            </svg>
        </a>
    </div>

    <!-- Property Modal -->
    <div id="propertyModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="modalTitle" class="text-2xl font-bold"></h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="modalContent" class="space-y-4">
                    <!-- Content will be populated by JavaScript -->
                </div>
                <div class="mt-6 flex space-x-4">
                    <button onclick="scheduleVisit()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition-colors">
                        Agendar Visita
                    </button>
                    <button onclick="requestInfo()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold transition-colors">
                        Falar com Marcio
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg max-w-md w-full p-6">
            <h3 class="text-2xl font-bold mb-4">Acesso do Corretor</h3>
            <form onsubmit="adminLogin(event)">
                <input type="password" id="adminPassword" placeholder="Digite a senha" required class="w-full p-3 border border-gray-300 rounded-lg mb-4 focus:ring-2 focus:ring-blue-500">
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition-colors">
                        Entrar
                    </button>
                    <button type="button" onclick="closeAdminLogin()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg font-semibold transition-colors">
                        Cancelar
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <button type="button" onclick="recoverPassword()" class="text-blue-600 hover:text-blue-800 text-sm underline">
                        Esqueci minha senha
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="fixed inset-0 bg-white z-50 hidden overflow-y-auto">
        <div class="container mx-auto px-4 py-8">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold">Painel do Corretor - Marcio Ramos</h2>
                <button onclick="closeAdminPanel()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">
                    Sair
                </button>
            </div>

            <!-- Pixel Configuration -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h3 class="text-xl font-bold mb-4">Configura√ß√£o de Pixels e Analytics</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Meta Pixel ID</label>
                        <input type="text" id="metaPixelInput" placeholder="Ex: 123456789012345" class="w-full p-3 border border-gray-300 rounded-lg text-sm">
                        <button onclick="installPixel('meta')" class="mt-2 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg text-sm">
                            Instalar Meta Pixel
                        </button>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Google Analytics ID</label>
                        <input type="text" id="googleAnalyticsInput" placeholder="Ex: G-XXXXXXXXXX" class="w-full p-3 border border-gray-300 rounded-lg text-sm">
                        <button onclick="installPixel('ga')" class="mt-2 w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg text-sm">
                            Instalar Google Analytics
                        </button>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Google Tag Manager ID</label>
                        <input type="text" id="googleTagManagerInput" placeholder="Ex: GTM-XXXXXXX" class="w-full p-3 border border-gray-300 rounded-lg text-sm">
                        <button onclick="installPixel('gtm')" class="mt-2 w-full bg-yellow-600 hover:bg-yellow-700 text-white py-2 rounded-lg text-sm">
                            Instalar GTM
                        </button>
                    </div>
                </div>
                <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                    <h4 class="font-semibold mb-2">Status dos Pixels:</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                        <div id="metaPixelStatus" class="flex items-center space-x-2">
                            <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                            <span>Meta Pixel: N√£o instalado</span>
                        </div>
                        <div id="gaStatus" class="flex items-center space-x-2">
                            <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                            <span>Google Analytics: N√£o instalado</span>
                        </div>
                        <div id="gtmStatus" class="flex items-center space-x-2">
                            <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                            <span>GTM: N√£o instalado</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Property Form -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h3 id="formTitle" class="text-xl font-bold mb-4">Adicionar Novo Im√≥vel</h3>
                <form id="addPropertyForm" onsubmit="addProperty(event)" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" name="title" placeholder="T√≠tulo do im√≥vel" required class="p-3 border border-gray-300 rounded-lg">
                        <input type="text" name="location" placeholder="Localiza√ß√£o" required class="p-3 border border-gray-300 rounded-lg">
                        <input type="text" name="price" placeholder="Pre√ßo (ex: R$ 500.000)" required class="p-3 border border-gray-300 rounded-lg">
                        <select name="type" required class="p-3 border border-gray-300 rounded-lg">
                            <option value="">Tipo de Im√≥vel</option>
                            <option value="casa">Casa</option>
                            <option value="apartamento">Apartamento</option>
                            <option value="terreno">Terreno</option>
                            <option value="comercial">Comercial</option>
                            <option value="chacara">Ch√°cara</option>
                            <option value="sobrado">Sobrado</option>
                        </select>
                        <select name="transaction" required class="p-3 border border-gray-300 rounded-lg">
                            <option value="">Tipo de Transa√ß√£o</option>
                            <option value="compra">Compra</option>
                            <option value="venda">Venda</option>
                            <option value="aluguel">Aluguel</option>
                        </select>
                        <input type="text" name="area" placeholder="√Årea (ex: 85m¬≤)" class="p-3 border border-gray-300 rounded-lg">
                        <input type="text" name="bedrooms" placeholder="Dormit√≥rios (ex: 3 dorms)" class="p-3 border border-gray-300 rounded-lg">
                        <input type="text" name="bathrooms" placeholder="Banheiros (ex: 2 banh)" class="p-3 border border-gray-300 rounded-lg">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" name="featured" id="featuredCheckbox" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                            <label for="featuredCheckbox" class="text-sm font-medium text-gray-700">Im√≥vel em Destaque</label>
                        </div>
                    </div>
                    
                    <textarea name="description" placeholder="Descri√ß√£o do im√≥vel" rows="3" required class="w-full p-3 border border-gray-300 rounded-lg"></textarea>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Foto Principal (Thumbnail)</label>
                            <input type="file" name="thumbnailImage" accept="image/*" class="w-full p-3 border border-gray-300 rounded-lg" onchange="previewThumbnail(this)">
                            <p class="text-sm text-gray-500 mt-1">Esta ser√° a imagem principal do im√≥vel</p>
                            <div id="thumbnailPreview" class="mt-2 hidden">
                                <p class="text-sm font-medium text-green-600 mb-2">üì∏ Nova foto principal selecionada:</p>
                                <div class="w-32 h-24 border-2 border-green-500 rounded overflow-hidden">
                                    <img id="thumbnailPreviewImg" src="" alt="Preview" class="w-full h-full object-cover">
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Galeria de Fotos (m√°ximo 11 fotos)</label>
                            <input type="file" name="galleryImages" accept="image/*" multiple class="w-full p-3 border border-gray-300 rounded-lg" onchange="previewGalleryImages(this)">
                            <p class="text-sm text-gray-500 mt-1">Fotos adicionais para a galeria do im√≥vel (ser√£o ADICIONADAS √†s existentes)</p>
                            <div id="galleryPreview" class="mt-2 hidden">
                                <p class="text-sm font-medium text-green-600 mb-2">üì∏ Novas fotos da galeria selecionadas:</p>
                                <div id="galleryPreviewGrid" class="grid grid-cols-4 gap-2"></div>
                            </div>
                        </div>
                        <div id="currentImages" class="hidden">
                            <label class="block text-sm font-medium mb-2">Imagens Atuais</label>
                            <div class="mb-3">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Foto Principal:</h4>
                                <div id="currentThumbnail" class="w-32 h-24"></div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Galeria:</h4>
                                <div id="currentImagesGrid" class="grid grid-cols-4 gap-2"></div>
                            </div>
                        </div>
                    </div>
                    
                    <textarea name="features" placeholder="Caracter√≠sticas (uma por linha)" rows="4" class="w-full p-3 border border-gray-300 rounded-lg"></textarea>
                    
                    <button type="submit" id="submitPropertyBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition-all">
                        ‚ûï Adicionar Im√≥vel
                    </button>
                </form>
            </div>

            <!-- Properties List -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4">Im√≥veis Cadastrados</h3>
                <div id="adminPropertiesList" class="space-y-4">
                    <!-- Properties will be listed here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let properties = JSON.parse(localStorage.getItem('properties')) || [];
        let isAdminLoggedIn = false;
        const ADMIN_PASSWORD = 'marcio123'; // Change this password
        let currentProperty = null;
        let currentImageIndex = 0;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadProperties();
        });

        // Property management functions
        function loadProperties() {
            const grid = document.getElementById('propertiesGrid');
            if (!grid) return;

            if (properties.length === 0) {
                // Add sample properties if none exist
                properties = [
                    {
                        id: 1,
                        title: "Casa Moderna",
                        location: "Vila Nova, S√£o Paulo",
                        price: "R$ 750.000",
                        type: "casa",
                        transaction: "venda",
                        bedrooms: "3 dorms",
                        bathrooms: "2 banh",
                        area: "120m¬≤",
                        description: "Casa moderna com acabamentos de primeira linha, jardim e garagem para 2 carros.",
                        features: ["Jardim privativo", "Garagem para 2 carros", "Churrasqueira", "√Årea de servi√ßo"],
                        images: []
                    },
                    {
                        id: 2,
                        title: "Apartamento Central",
                        location: "Centro, S√£o Paulo",
                        price: "R$ 450.000",
                        type: "apartamento",
                        transaction: "compra",
                        bedrooms: "2 dorms",
                        bathrooms: "1 banh",
                        area: "65m¬≤",
                        description: "Apartamento bem localizado no centro da cidade, pr√≥ximo ao metr√¥ e com√©rcio.",
                        features: ["Pr√≥ximo ao metr√¥", "Portaria 24h", "Elevador", "√Årea de lazer"],
                        images: []
                    },
                    {
                        id: 3,
                        title: "Sobrado Familiar",
                        location: "Jardim Am√©rica, S√£o Paulo",
                        price: "R$ 2.500/m√™s",
                        type: "sobrado",
                        transaction: "aluguel",
                        bedrooms: "4 dorms",
                        bathrooms: "3 banh",
                        area: "180m¬≤",
                        description: "Sobrado espa√ßoso ideal para fam√≠lias, com quintal e √°rea gourmet.",
                        features: ["Quintal amplo", "√Årea gourmet", "3 vagas de garagem", "Piscina"],
                        images: []
                    }
                ];
                localStorage.setItem('properties', JSON.stringify(properties));
            }

            displayProperties(properties);
        }

        function displayProperties(propertiesToShow) {
            const grid = document.getElementById('propertiesGrid');
            if (!grid) return;

            grid.innerHTML = '';

            // Ordenar por destaque primeiro, depois por ID (mais recentes primeiro)
            const sortedProperties = propertiesToShow.sort((a, b) => {
                if (a.featured && !b.featured) return -1;
                if (!a.featured && b.featured) return 1;
                return b.id - a.id;
            });

            sortedProperties.forEach(property => {
                const propertyCard = createPropertyCard(property);
                grid.appendChild(propertyCard);
            });
        }

        function createPropertyCard(property) {
            const card = document.createElement('div');
            card.className = 'property-card bg-white rounded-lg shadow-lg overflow-hidden';
            
            const typeEmoji = {
                'casa': 'üè†',
                'apartamento': 'üè¢',
                'terreno': 'üå±',
                'comercial': 'üè¨',
                'chacara': 'üå≥',
                'sobrado': 'üèòÔ∏è'
            };

            // Debug: verificar se h√° imagens
            console.log('Property:', property.title, 'Images:', property.images?.length || 0);

            let imageHtml = '';
            if (property.images && property.images.length > 0 && property.images[0]) {
                imageHtml = `<img src="${property.images[0]}" alt="${property.title}" class="w-full h-48 object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="w-full h-48 bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center" style="display:none;">
                    <span class="text-white text-6xl">${typeEmoji[property.type] || 'üè†'}</span>
                </div>`;
            } else {
                imageHtml = `<div class="w-full h-48 bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center">
                    <span class="text-white text-6xl">${typeEmoji[property.type] || 'üè†'}</span>
                </div>`;
            }

            card.innerHTML = `
                <div class="relative">
                    ${imageHtml}
                    <div class="absolute top-4 left-4 bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                        ${property.transaction.charAt(0).toUpperCase() + property.transaction.slice(1)}
                    </div>
                    ${property.featured ? `
                    <div class="absolute top-4 right-4 bg-yellow-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                        ‚≠ê Destaque
                    </div>
                    ` : ''}
                </div>
                <div class="p-6">
                    <h4 class="text-xl font-semibold mb-2">${property.title}</h4>
                    <p class="text-gray-600 mb-3">${property.location}</p>
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-2xl font-bold text-blue-600">${property.price}</span>
                        <div class="flex space-x-4 text-sm text-gray-500">
                            ${property.bedrooms ? `<span>üõèÔ∏è ${property.bedrooms}</span>` : ''}
                            ${property.bathrooms ? `<span>üöø ${property.bathrooms}</span>` : ''}
                            ${property.area ? `<span>üìê ${property.area}</span>` : ''}
                        </div>
                    </div>
                    <button onclick="viewProperty(${property.id})" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors">
                        Ver Detalhes
                    </button>
                </div>
            `;

            return card;
        }

        // Search and filter functions
        function searchProperties() {
            const type = document.getElementById('propertyType').value;
            const transaction = document.getElementById('transactionType').value;
            const priceRange = document.getElementById('priceRange').value;

            let filtered = properties;

            if (type) {
                filtered = filtered.filter(p => p.type === type);
            }

            if (transaction) {
                filtered = filtered.filter(p => p.transaction === transaction);
            }

            if (priceRange) {
                // Simple price filtering (you can make this more sophisticated)
                const maxPrice = parseInt(priceRange.replace(/\D/g, ''));
                filtered = filtered.filter(p => {
                    const propertyPrice = parseInt(p.price.replace(/\D/g, ''));
                    return propertyPrice <= maxPrice;
                });
            }

            displayProperties(filtered);

            // Track search
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Search');
            }
            if (typeof gtag !== 'undefined') {
                gtag('event', 'search', {
                    'event_category': 'engagement'
                });
            }
        }

        function filterProperties(transaction) {
            const filtered = properties.filter(p => p.transaction === transaction);
            displayProperties(filtered);
        }

        // Mobile menu functions
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuIcon = document.getElementById('menuIcon');
            const closeIcon = document.getElementById('closeIcon');
            
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
                menuIcon.classList.add('hidden');
                closeIcon.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
                menuIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }
        }

        function closeMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuIcon = document.getElementById('menuIcon');
            const closeIcon = document.getElementById('closeIcon');
            
            mobileMenu.classList.add('hidden');
            menuIcon.classList.remove('hidden');
            closeIcon.classList.add('hidden');
        }

        // SEO functions
        function updateSEOForProperty(property) {
            const title = `${property.title} - ${property.location} | Marcio Ramos Im√≥veis`;
            const description = `${property.description} ${property.type} para ${property.transaction} por ${property.price}. ${property.bedrooms || ''} ${property.bathrooms || ''} ${property.area || ''}`.trim();
            const url = `https://marcioramosimoveis.com.br/imovel/${property.id}`;
            
            // Update page title and meta tags
            document.getElementById('pageTitle').textContent = title;
            document.getElementById('pageDescription').setAttribute('content', description);
            document.getElementById('canonical').setAttribute('href', url);
            
            // Update Open Graph tags
            document.getElementById('ogTitle').setAttribute('content', title);
            document.getElementById('ogDescription').setAttribute('content', description);
            document.getElementById('ogUrl').setAttribute('content', url);
            
            // Update Twitter tags
            document.getElementById('twitterTitle').setAttribute('content', title);
            document.getElementById('twitterDescription').setAttribute('content', description);
            document.getElementById('twitterUrl').setAttribute('content', url);
            
            // Update structured data
            const structuredData = {
                "@context": "https://schema.org",
                "@type": "RealEstate",
                "name": property.title,
                "description": property.description,
                "address": {
                    "@type": "PostalAddress",
                    "addressLocality": property.location
                },
                "offers": {
                    "@type": "Offer",
                    "price": property.price,
                    "priceCurrency": "BRL",
                    "availability": "https://schema.org/InStock"
                },
                "realEstateAgent": {
                    "@type": "RealEstateAgent",
                    "name": "Marcio Ramos Im√≥veis"
                }
            };
            
            document.getElementById('structuredData').textContent = JSON.stringify(structuredData);
            
            // Update browser history
            if (history.pushState) {
                history.pushState({propertyId: property.id}, title, `#imovel-${property.id}`);
            }
        }

        function resetSEO() {
            const title = 'Marcio Ramos Im√≥veis - Sua Imobili√°ria Digital';
            const description = 'Encontre os melhores im√≥veis com Marcio Ramos, corretor especialista h√° 15 anos. Casas, apartamentos, terrenos para compra, venda e aluguel.';
            const url = 'https://marcioramosimoveis.com.br';
            
            document.getElementById('pageTitle').textContent = title;
            document.getElementById('pageDescription').setAttribute('content', description);
            document.getElementById('canonical').setAttribute('href', url);
            document.getElementById('ogTitle').setAttribute('content', title);
            document.getElementById('ogDescription').setAttribute('content', description);
            document.getElementById('ogUrl').setAttribute('content', url);
            document.getElementById('twitterTitle').setAttribute('content', title);
            document.getElementById('twitterDescription').setAttribute('content', description);
            document.getElementById('twitterUrl').setAttribute('content', url);
            
            const originalStructuredData = {
                "@context": "https://schema.org",
                "@type": "RealEstateAgent",
                "name": "Marcio Ramos Im√≥veis",
                "description": "Corretor de im√≥veis especialista h√° mais de 15 anos",
                "url": "https://marcioramosimoveis.com.br",
                "telephone": "+55-11-99999-9999",
                "email": "marcio@marcioramosimoveis.com.br",
                "address": {
                    "@type": "PostalAddress",
                    "streetAddress": "Rua das Flores, 123",
                    "addressLocality": "S√£o Paulo",
                    "addressRegion": "SP",
                    "postalCode": "01000-000",
                    "addressCountry": "BR"
                },
                "sameAs": [
                    "https://www.facebook.com/marcioramosimoveis",
                    "https://www.instagram.com/marcioramosimoveis"
                ]
            };
            
            document.getElementById('structuredData').textContent = JSON.stringify(originalStructuredData);
            
            if (history.pushState) {
                history.pushState({}, title, window.location.pathname);
            }
        }

        // Image validation and preview functions
        function validateGalleryCount(input) {
            if (input.files.length > 11) {
                alert('M√°ximo de 11 imagens na galeria!');
                input.value = '';
                return false;
            }
            return true;
        }

        function previewThumbnail(input) {
            const preview = document.getElementById('thumbnailPreview');
            const previewImg = document.getElementById('thumbnailPreviewImg');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(input.files[0]);
            } else {
                preview.classList.add('hidden');
            }
        }

        function previewGalleryImages(input) {
            const preview = document.getElementById('galleryPreview');
            const previewGrid = document.getElementById('galleryPreviewGrid');
            
            // Validate count first
            if (!validateGalleryCount(input)) {
                return;
            }
            
            if (input.files && input.files.length > 0) {
                previewGrid.innerHTML = '';
                
                Array.from(input.files).forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imgDiv = document.createElement('div');
                        imgDiv.className = 'relative border-2 border-green-500 rounded overflow-hidden';
                        imgDiv.innerHTML = `
                            <img src="${e.target.result}" alt="Preview ${index + 1}" class="w-full h-20 object-cover">
                            <div class="absolute bottom-0 left-0 bg-green-500 text-white text-xs px-1 rounded-tr">NOVA</div>
                        `;
                        previewGrid.appendChild(imgDiv);
                    };
                    reader.readAsDataURL(file);
                });
                
                preview.classList.remove('hidden');
            } else {
                preview.classList.add('hidden');
            }
        }

        // Gallery navigation functions
        function selectImage(index) {
            if (!currentProperty || !currentProperty.images) return;
            
            currentImageIndex = index;
            const mainImage = document.getElementById('mainImage');
            const thumbnails = document.querySelectorAll('.gallery-thumbnail');
            
            if (mainImage) {
                mainImage.src = currentProperty.images[index];
            }
            
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
        }

        function previousImage() {
            if (!currentProperty || !currentProperty.images) return;
            
            currentImageIndex = currentImageIndex > 0 ? currentImageIndex - 1 : currentProperty.images.length - 1;
            selectImage(currentImageIndex);
        }

        function nextImage() {
            if (!currentProperty || !currentProperty.images) return;
            
            currentImageIndex = currentImageIndex < currentProperty.images.length - 1 ? currentImageIndex + 1 : 0;
            selectImage(currentImageIndex);
        }

        // Property modal functions
        function viewProperty(id) {
            const property = properties.find(p => p.id === id);
            if (!property) return;

            currentProperty = property;
            currentImageIndex = 0;

            // Update SEO for this property
            updateSEOForProperty(property);

            // Track property view
            if (typeof fbq !== 'undefined') {
                fbq('track', 'ViewContent', {
                    content_name: property.title,
                    content_category: 'Property'
                });
            }

            document.getElementById('modalTitle').textContent = property.title;
            
            let galleryHtml = '';
            if (property.images && property.images.length > 0) {
                galleryHtml = `
                    <div class="image-gallery mb-4">
                        <div class="relative">
                            <img id="mainImage" src="${property.images[0]}" alt="${property.title}" class="w-full h-80 object-cover rounded-lg gallery-main-image">
                            ${property.images.length > 1 ? `
                                <button class="gallery-nav-btn prev" onclick="previousImage()">‚Äπ</button>
                                <button class="gallery-nav-btn next" onclick="nextImage()">‚Ä∫</button>
                            ` : ''}
                        </div>
                        ${property.images.length > 1 ? `
                            <div class="grid grid-cols-6 gap-2 mt-3">
                                ${property.images.map((img, index) => `
                                    <div class="relative group">
                                        <img src="${img}" alt="Foto ${index + 1}" 
                                             class="w-full h-16 object-cover rounded gallery-thumbnail ${index === 0 ? 'active' : ''}" 
                                             onclick="selectImage(${index})">
                                        ${isAdminLoggedIn ? `
                                            <button onclick="event.stopPropagation(); removeImageFromModal(${property.id}, ${index});" 
                                                    class="absolute -top-2 -right-2 bg-red-600 hover:bg-red-700 text-white rounded-full w-6 h-6 text-sm hover:scale-110 opacity-0 group-hover:opacity-100 transition-all z-50 flex items-center justify-center font-bold shadow-xl border-2 border-white cursor-pointer"
                                                    title="üóëÔ∏è Remover esta foto">
                                                ‚úï
                                            </button>
                                        ` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            } else {
                const typeEmoji = {
                    'casa': 'üè†',
                    'apartamento': 'üè¢',
                    'terreno': 'üå±',
                    'comercial': 'üè¨',
                    'chacara': 'üå≥',
                    'sobrado': 'üèòÔ∏è'
                };
                galleryHtml = `<div class="w-full h-80 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center mb-4">
                    <span class="text-white text-8xl">${typeEmoji[property.type] || 'üè†'}</span>
                </div>`;
            }

            document.getElementById('modalContent').innerHTML = `
                ${galleryHtml}
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div><strong>Localiza√ß√£o:</strong> ${property.location}</div>
                    <div><strong>Pre√ßo:</strong> ${property.price}</div>
                    <div><strong>Tipo:</strong> ${property.type.charAt(0).toUpperCase() + property.type.slice(1)}</div>
                    <div><strong>Transa√ß√£o:</strong> ${property.transaction.charAt(0).toUpperCase() + property.transaction.slice(1)}</div>
                    ${property.bedrooms ? `<div><strong>Dormit√≥rios:</strong> ${property.bedrooms}</div>` : ''}
                    ${property.bathrooms ? `<div><strong>Banheiros:</strong> ${property.bathrooms}</div>` : ''}
                    ${property.area ? `<div><strong>√Årea:</strong> ${property.area}</div>` : ''}
                </div>
                <div class="mb-4">
                    <strong>Descri√ß√£o:</strong>
                    <p class="mt-2 text-gray-600">${property.description}</p>
                </div>
                ${property.features && property.features.length > 0 ? `
                <div>
                    <strong>Caracter√≠sticas:</strong>
                    <ul class="mt-2 list-disc list-inside text-gray-600">
                        ${property.features.map(feature => `<li>${feature}</li>`).join('')}
                    </ul>
                </div>
                ` : ''}
            `;
            
            document.getElementById('propertyModal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('propertyModal').classList.add('hidden');
            resetSEO(); // Reset SEO when closing modal
        }

        // Admin functions
        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('hidden');
        }

        function closeAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('hidden');
            document.getElementById('adminPassword').value = '';
        }

        function adminLogin(event) {
            event.preventDefault();
            const password = document.getElementById('adminPassword').value;
            
            if (password === ADMIN_PASSWORD) {
                isAdminLoggedIn = true;
                closeAdminLogin();
                showAdminPanel();
            } else {
                alert('Senha incorreta!');
            }
        }

        function showAdminPanel() {
            document.getElementById('adminPanel').classList.remove('hidden');
            loadAdminProperties();
            updatePixelStatus();
        }

        // Pixel installation functions
        function installPixel(type) {
            let pixelId, inputId;
            
            switch(type) {
                case 'meta':
                    pixelId = document.getElementById('metaPixelInput').value.trim();
                    if (!pixelId) {
                        alert('Por favor, insira o ID do Meta Pixel');
                        return;
                    }
                    localStorage.setItem('metaPixelId', pixelId);
                    installMetaPixel(pixelId);
                    break;
                    
                case 'ga':
                    pixelId = document.getElementById('googleAnalyticsInput').value.trim();
                    if (!pixelId) {
                        alert('Por favor, insira o ID do Google Analytics');
                        return;
                    }
                    localStorage.setItem('googleAnalyticsId', pixelId);
                    installGoogleAnalytics(pixelId);
                    break;
                    
                case 'gtm':
                    pixelId = document.getElementById('googleTagManagerInput').value.trim();
                    if (!pixelId) {
                        alert('Por favor, insira o ID do Google Tag Manager');
                        return;
                    }
                    localStorage.setItem('googleTagManagerId', pixelId);
                    installGoogleTagManager(pixelId);
                    break;
            }
            
            updatePixelStatus();
            alert(`${type.toUpperCase()} instalado com sucesso! ID: ${pixelId}`);
        }

        function updatePixelStatus() {
            // Meta Pixel Status
            const metaPixelId = localStorage.getItem('metaPixelId');
            const metaStatus = document.getElementById('metaPixelStatus');
            if (metaPixelId && metaPixelId !== 'SEU_PIXEL_ID_AQUI' && typeof fbq !== 'undefined') {
                metaStatus.innerHTML = `
                    <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                    <span>Meta Pixel: Ativo (${metaPixelId})</span>
                `;
            } else {
                metaStatus.innerHTML = `
                    <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                    <span>Meta Pixel: N√£o instalado</span>
                `;
            }
            
            // Google Analytics Status
            const gaId = localStorage.getItem('googleAnalyticsId');
            const gaStatus = document.getElementById('gaStatus');
            if (gaId && gaId !== 'GA_MEASUREMENT_ID' && typeof gtag !== 'undefined') {
                gaStatus.innerHTML = `
                    <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                    <span>Google Analytics: Ativo (${gaId})</span>
                `;
            } else {
                gaStatus.innerHTML = `
                    <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                    <span>Google Analytics: N√£o instalado</span>
                `;
            }
            
            // GTM Status
            const gtmId = localStorage.getItem('googleTagManagerId');
            const gtmStatus = document.getElementById('gtmStatus');
            if (gtmId && gtmId !== 'GTM-XXXXXXX' && window.dataLayer) {
                gtmStatus.innerHTML = `
                    <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                    <span>GTM: Ativo (${gtmId})</span>
                `;
            } else {
                gtmStatus.innerHTML = `
                    <span class="w-3 h-3 bg-red-500 rounded-full"></span>
                    <span>GTM: N√£o instalado</span>
                `;
            }
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.add('hidden');
            isAdminLoggedIn = false;
        }

        function loadAdminProperties() {
            const list = document.getElementById('adminPropertiesList');
            list.innerHTML = '';

            properties.forEach(property => {
                const item = document.createElement('div');
                item.className = 'border border-gray-200 rounded-lg p-4 flex justify-between items-center';
                item.innerHTML = `
                    <div>
                        <h4 class="font-semibold flex items-center space-x-2">
                            <span>${property.title}</span>
                            ${property.featured ? '<span class="bg-yellow-500 text-white px-2 py-1 rounded-full text-xs">‚≠ê Destaque</span>' : ''}
                        </h4>
                        <p class="text-gray-600">${property.location} - ${property.price}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editProperty(${property.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm">
                            Editar
                        </button>
                        <button onclick="duplicateProperty(${property.id})" class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm">
                            Duplicar
                        </button>
                        <button onclick="deleteProperty(${property.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                            Excluir
                        </button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function addProperty(event) {
            event.preventDefault();
            console.log('üè† INICIANDO PROCESSO DE ADI√á√ÉO/ATUALIZA√á√ÉO');
            
            const form = event.target;
            const formData = new FormData(form);

            // Verificar se estamos editando ou adicionando
            const editingId = form.dataset.editingId;
            
            if (editingId) {
                console.log('‚úèÔ∏è MODO EDI√á√ÉO DETECTADO - ID:', editingId);
                // Estamos editando
                updateProperty(parseInt(editingId), formData, form);
                return;
            }

            console.log('‚ûï MODO ADI√á√ÉO DETECTADO');

            // Estamos adicionando novo im√≥vel
            const newProperty = {
                id: Date.now(),
                title: formData.get('title'),
                location: formData.get('location'),
                price: formData.get('price'),
                type: formData.get('type'),
                transaction: formData.get('transaction'),
                area: formData.get('area'),
                bedrooms: formData.get('bedrooms'),
                bathrooms: formData.get('bathrooms'),
                description: formData.get('description'),
                features: formData.get('features').split('\n').filter(f => f.trim()),
                featured: formData.get('featured') === 'on',
                images: []
            };

            console.log('üìù Novo im√≥vel criado:', newProperty.title);
            console.log('‚≠ê Destaque:', newProperty.featured);

            const allFiles = [];
            
            // Coletar thumbnail primeiro
            const thumbnailFile = formData.get('thumbnailImage');
            if (thumbnailFile && thumbnailFile.size > 0) {
                console.log('üñºÔ∏è Thumbnail detectada');
                allFiles.push(thumbnailFile);
            }

            // Coletar arquivos da galeria
            const galleryFiles = formData.getAll('galleryImages');
            if (galleryFiles && galleryFiles.length > 0) {
                galleryFiles.forEach(file => {
                    if (file.size > 0 && allFiles.length < 12) { // M√°ximo 12 imagens total
                        console.log('üñºÔ∏è Imagem da galeria detectada');
                        allFiles.push(file);
                    }
                });
            }

            console.log('üìÅ Total de arquivos para processar:', allFiles.length);

            if (allFiles.length > 0) {
                // USAR PROMISE.ALL PARA PROCESSAR TODAS AS IMAGENS
                const imagePromises = allFiles.map((file, index) => {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            resolve(e.target.result);
                        };
                        reader.onerror = function(error) {
                            console.error('‚ùå Erro ao ler arquivo:', error);
                            reject(error);
                        };
                        reader.readAsDataURL(file);
                    });
                });

                Promise.all(imagePromises)
                    .then(results => {
                        console.log('üìä Todas as imagens processadas:', results.length);
                        newProperty.images = results;
                        saveProperty();
                    })
                    .catch(error => {
                        console.error('‚ùå Erro ao processar imagens:', error);
                        alert('‚ùå Erro ao processar as imagens. Tente novamente.');
                    });
            } else {
                console.log('üíæ Salvando sem imagens');
                saveProperty();
            }

            function saveProperty() {
                try {
                    console.log('üíæ SALVANDO NOVO IM√ìVEL');
                    
                    properties.push(newProperty);
                    
                    // Salvar no localStorage com verifica√ß√£o
                    try {
                        localStorage.setItem('properties', JSON.stringify(properties));
                        console.log('‚úÖ Im√≥vel salvo no localStorage');
                    } catch (storageError) {
                        console.error('‚ùå Erro no localStorage:', storageError);
                        throw new Error('Erro ao salvar no navegador. Talvez as imagens sejam muito grandes.');
                    }
                    
                    console.log('üìä Total de im√≥veis:', properties.length);
                    
                    // Usar setTimeout para garantir que a UI seja atualizada
                    setTimeout(() => {
                        loadProperties();
                        loadAdminProperties();
                        console.log('üîÑ Displays atualizados');
                        
                        form.reset();
                        
                        // Esconder previews ap√≥s salvar
                        document.getElementById('thumbnailPreview').classList.add('hidden');
                        document.getElementById('galleryPreview').classList.add('hidden');
                        
                        console.log('‚úÖ NOVO IM√ìVEL ADICIONADO COM SUCESSO!');
                        alert('‚úÖ Im√≥vel adicionado com sucesso!');
                    }, 100);
                    
                } catch (error) {
                    console.error('‚ùå Erro ao salvar:', error);
                    alert(`‚ùå Erro ao salvar: ${error.message}`);
                }
            }
        }

        function editProperty(id) {
            console.log('‚úèÔ∏è INICIANDO EDI√á√ÉO - ID:', id);
            
            const property = properties.find(p => p.id === id);
            if (!property) {
                console.error('‚ùå Propriedade n√£o encontrada');
                return;
            }

            console.log('üìù Propriedade encontrada:', property.title);

            // Alterar t√≠tulo do formul√°rio
            document.getElementById('formTitle').textContent = 'Editar Im√≥vel';

            // Preencher o formul√°rio com os dados do im√≥vel
            const form = document.getElementById('addPropertyForm');
            
            // LIMPAR CAMPOS DE ARQUIVO PRIMEIRO
            const thumbnailInput = form.querySelector('input[name="thumbnailImage"]');
            const galleryInput = form.querySelector('input[name="galleryImages"]');
            if (thumbnailInput) thumbnailInput.value = '';
            if (galleryInput) galleryInput.value = '';
            
            // Esconder previews
            document.getElementById('thumbnailPreview').classList.add('hidden');
            document.getElementById('galleryPreview').classList.add('hidden');
            
            form.elements.title.value = property.title;
            form.elements.location.value = property.location;
            form.elements.price.value = property.price;
            form.elements.type.value = property.type;
            form.elements.transaction.value = property.transaction;
            form.elements.area.value = property.area || '';
            form.elements.bedrooms.value = property.bedrooms || '';
            form.elements.bathrooms.value = property.bathrooms || '';
            form.elements.description.value = property.description;
            form.elements.features.value = property.features ? property.features.join('\n') : '';
            form.elements.featured.checked = property.featured || false;

            // Marcar que estamos editando
            form.dataset.editingId = id;

            console.log('üìä Formul√°rio preenchido');

            // Mostrar imagens atuais usando a fun√ß√£o dedicada
            updateCurrentImagesDisplay(id);

            // Alterar o bot√£o para "Atualizar" espec√≠fico para este im√≥vel
            const submitBtn = form.querySelector('#submitPropertyBtn');
            submitBtn.innerHTML = `üîÑ Atualizar "${property.title}"`;
            submitBtn.className = 'w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold transition-all';
            
            // Adicionar bot√£o cancelar se n√£o existir
            let cancelBtn = form.querySelector('.cancel-edit-btn');
            if (!cancelBtn) {
                cancelBtn = document.createElement('button');
                cancelBtn.type = 'button';
                cancelBtn.className = 'cancel-edit-btn w-full bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg font-semibold mt-2 transition-all';
                cancelBtn.innerHTML = '‚ùå Cancelar Edi√ß√£o';
                cancelBtn.onclick = function() {
                    cancelEdit(form);
                };
                submitBtn.parentNode.insertBefore(cancelBtn, submitBtn.nextSibling);
            }

            console.log('‚úÖ Modo de edi√ß√£o ativado');

            // Scroll para o formul√°rio
            form.scrollIntoView({ behavior: 'smooth' });
        }

        function removeImage(propertyId, imageIndex) {
            console.log('üóëÔ∏è REMOVENDO IMAGEM - ID:', propertyId, 'Index:', imageIndex);
            
            if (!confirm('‚ùå Remover esta imagem permanentemente?')) {
                console.log('‚ùå Remo√ß√£o cancelada pelo usu√°rio');
                return;
            }
            
            try {
                const propertyIndex = properties.findIndex(p => p.id === propertyId);
                console.log('üìç Property index encontrado:', propertyIndex);
                
                if (propertyIndex === -1) {
                    throw new Error('Propriedade n√£o encontrada');
                }
                
                if (!properties[propertyIndex].images || !Array.isArray(properties[propertyIndex].images)) {
                    throw new Error('Array de imagens n√£o existe');
                }
                
                if (imageIndex < 0 || imageIndex >= properties[propertyIndex].images.length) {
                    throw new Error(`√çndice inv√°lido: ${imageIndex}. Array tem ${properties[propertyIndex].images.length} itens`);
                }
                
                console.log('üîç Antes da remo√ß√£o:', properties[propertyIndex].images.length, 'imagens');
                console.log('üéØ Removendo √≠ndice:', imageIndex);
                
                // REMOVER A IMAGEM DO ARRAY
                const removedImage = properties[propertyIndex].images.splice(imageIndex, 1);
                console.log('‚úÇÔ∏è Imagem removida:', removedImage.length > 0 ? 'Sucesso' : 'Falhou');
                console.log('üìä Ap√≥s remo√ß√£o:', properties[propertyIndex].images.length, 'imagens');
                
                // SALVAR NO LOCALSTORAGE
                localStorage.setItem('properties', JSON.stringify(properties));
                console.log('üíæ Salvo no localStorage');
                
                // ATUALIZAR TODOS OS DISPLAYS
                loadProperties();
                loadAdminProperties();
                updateCurrentImagesDisplay(propertyId);
                console.log('üîÑ Displays atualizados');
                
                alert('‚úÖ Imagem removida com sucesso!');
                console.log('‚úÖ REMO√á√ÉO CONCLU√çDA COM SUCESSO');
                
            } catch (error) {
                console.error('‚ùå ERRO NA REMO√á√ÉO:', error.message);
                console.error('üìä Estado atual:', {
                    propertyIndex: properties.findIndex(p => p.id === propertyId),
                    totalProperties: properties.length,
                    imageIndex: imageIndex,
                    imagesLength: properties.find(p => p.id === propertyId)?.images?.length || 'N/A'
                });
                alert(`‚ùå Erro ao remover imagem: ${error.message}`);
            }
        }

        function updateCurrentImagesDisplay(propertyId) {
            console.log('üñºÔ∏è ATUALIZANDO DISPLAY DE IMAGENS - ID:', propertyId);
            
            const property = properties.find(p => p.id === propertyId);
            if (!property) {
                console.log('‚ùå Propriedade n√£o encontrada');
                return;
            }

            console.log('üìä Propriedade encontrada:', property.title);
            console.log('üñºÔ∏è Total de imagens:', property.images?.length || 0);

            const currentImagesDiv = document.getElementById('currentImages');
            const currentThumbnail = document.getElementById('currentThumbnail');
            const currentImagesGrid = document.getElementById('currentImagesGrid');
            
            // Limpar conte√∫do anterior
            currentThumbnail.innerHTML = '';
            currentImagesGrid.innerHTML = '';
            
            if (property.images && property.images.length > 0) {
                console.log('‚úÖ Exibindo imagens existentes');
                currentImagesDiv.classList.remove('hidden');
                
                // Mostrar thumbnail (primeira imagem)
                const thumbnailDiv = document.createElement('div');
                thumbnailDiv.className = 'relative group';
                thumbnailDiv.innerHTML = `
                    <img src="${property.images[0]}" alt="Foto Principal" class="w-full h-24 object-cover rounded border-2 border-blue-500">
                    <button type="button" onclick="removeImage(${propertyId}, 0);" 
                            class="absolute -top-2 -right-2 bg-red-600 hover:bg-red-700 hover:scale-110 text-white rounded-full w-7 h-7 text-sm transition-all z-50 flex items-center justify-center font-bold shadow-xl border-2 border-white cursor-pointer opacity-0 group-hover:opacity-100"
                            title="üóëÔ∏è Remover foto principal">
                        ‚úï
                    </button>
                    <div class="absolute bottom-0 left-0 bg-blue-500 text-white text-xs px-1 rounded-tr">THUMBNAIL</div>
                `;
                currentThumbnail.appendChild(thumbnailDiv);
                console.log('üì∏ Thumbnail exibida');
                
                // Mostrar galeria (demais imagens)
                if (property.images.length > 1) {
                    console.log('üñºÔ∏è Exibindo', property.images.length - 1, 'imagens da galeria');
                    property.images.slice(1).forEach((img, index) => {
                        const realIndex = index + 1; // +1 porque come√ßamos do √≠ndice 1
                        const imgDiv = document.createElement('div');
                        imgDiv.className = 'relative group';
                        imgDiv.innerHTML = `
                            <img src="${img}" alt="Foto ${realIndex + 1}" class="w-full h-20 object-cover rounded border">
                            <button type="button" onclick="removeImage(${propertyId}, ${realIndex});" 
                                    class="absolute -top-2 -right-2 bg-red-600 hover:bg-red-700 hover:scale-110 text-white rounded-full w-6 h-6 text-xs transition-all z-50 flex items-center justify-center font-bold shadow-xl border-2 border-white cursor-pointer opacity-0 group-hover:opacity-100"
                                    title="üóëÔ∏è Remover esta foto">
                                ‚úï
                            </button>
                            <div class="absolute bottom-0 left-0 bg-gray-600 text-white text-xs px-1 rounded-tr">${realIndex}</div>
                        `;
                        currentImagesGrid.appendChild(imgDiv);
                    });
                    console.log('‚úÖ Galeria exibida');
                }
            } else {
                console.log('üì≠ Nenhuma imagem para exibir');
                currentImagesDiv.classList.add('hidden');
            }
            
            console.log('‚úÖ Display de imagens atualizado');
        }

        function cancelEdit(form) {
            console.log('‚ùå CANCELANDO EDI√á√ÉO');
            
            // Restaurar t√≠tulo do formul√°rio
            document.getElementById('formTitle').textContent = 'Adicionar Novo Im√≥vel';
            
            // Resetar o formul√°rio completamente
            form.reset();
            document.getElementById('currentImages').classList.add('hidden');
            
            // Esconder previews
            document.getElementById('thumbnailPreview').classList.add('hidden');
            document.getElementById('galleryPreview').classList.add('hidden');
            
            // Limpar campos de arquivo explicitamente
            const thumbnailInput = form.querySelector('input[name="thumbnailImage"]');
            const galleryInput = form.querySelector('input[name="galleryImages"]');
            if (thumbnailInput) thumbnailInput.value = '';
            if (galleryInput) galleryInput.value = '';
            
            // Remover marca√ß√£o de edi√ß√£o
            delete form.dataset.editingId;
            
            // Restaurar bot√£o original
            const submitBtn = form.querySelector('#submitPropertyBtn');
            submitBtn.innerHTML = '‚ûï Adicionar Im√≥vel';
            submitBtn.className = 'w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-semibold transition-all';
            
            // Remover bot√£o cancelar
            const cancelBtn = form.querySelector('.cancel-edit-btn');
            if (cancelBtn) {
                cancelBtn.remove();
            }
            
            console.log('‚úÖ Modo de edi√ß√£o cancelado');
            
            // Scroll para o topo do formul√°rio
            form.scrollIntoView({ behavior: 'smooth' });
        }

        function removeImageFromModal(propertyId, imageIndex) {
            console.log('Removendo imagem do modal:', propertyId, imageIndex);
            
            if (confirm('Remover esta imagem?')) {
                const propertyIndex = properties.findIndex(p => p.id === propertyId);
                console.log('Property index no modal:', propertyIndex);
                
                if (propertyIndex !== -1 && properties[propertyIndex].images && properties[propertyIndex].images[imageIndex] !== undefined) {
                    console.log('Removendo imagem do modal, √≠ndice:', imageIndex);
                    properties[propertyIndex].images.splice(imageIndex, 1);
                    localStorage.setItem('properties', JSON.stringify(properties));
                    
                    // Update current property reference
                    currentProperty = properties[propertyIndex];
                    
                    // Adjust current image index if necessary
                    if (currentImageIndex >= currentProperty.images.length) {
                        currentImageIndex = Math.max(0, currentProperty.images.length - 1);
                    }
                    
                    console.log('Imagens restantes no modal:', currentProperty.images.length);
                    
                    // Refresh displays
                    loadProperties();
                    loadAdminProperties();
                    
                    // Refresh modal content
                    viewProperty(propertyId);
                    
                    alert('Imagem removida com sucesso!');
                } else {
                    console.error('Erro: Imagem n√£o encontrada no modal');
                    alert('Erro: Imagem n√£o encontrada');
                }
            }
        }

        function updateProperty(id, formData, form) {
            console.log('üîÑ INICIANDO ATUALIZA√á√ÉO - ID:', id);
            
            const propertyIndex = properties.findIndex(p => p.id === id);
            
            if (propertyIndex === -1) {
                alert('‚ùå Erro: Im√≥vel n√£o encontrado!');
                return;
            }

            console.log('üìù Propriedade encontrada no √≠ndice:', propertyIndex);

            // Criar uma c√≥pia limpa da propriedade existente
            const currentProperty = JSON.parse(JSON.stringify(properties[propertyIndex]));
            
            // Atualizar APENAS os dados do formul√°rio (preservar imagens existentes)
            const updatedProperty = {
                id: currentProperty.id,
                title: formData.get('title'),
                location: formData.get('location'),
                price: formData.get('price'),
                type: formData.get('type'),
                transaction: formData.get('transaction'),
                area: formData.get('area') || '',
                bedrooms: formData.get('bedrooms') || '',
                bathrooms: formData.get('bathrooms') || '',
                description: formData.get('description'),
                features: formData.get('features').split('\n').filter(f => f.trim()),
                featured: formData.get('featured') === 'on',
                images: [...(currentProperty.images || [])] // PRESERVAR imagens existentes
            };

            console.log('üìä Dados b√°sicos atualizados');
            console.log('üñºÔ∏è Imagens preservadas:', updatedProperty.images.length);

            const newFiles = [];
            
            // Verificar nova thumbnail
            const thumbnailFile = formData.get('thumbnailImage');
            if (thumbnailFile && thumbnailFile.size > 0) {
                console.log('üñºÔ∏è Nova thumbnail detectada');
                newFiles.push({file: thumbnailFile, type: 'thumbnail'});
            }

            // Verificar novas imagens da galeria
            const galleryFiles = formData.getAll('galleryImages');
            if (galleryFiles && galleryFiles.length > 0) {
                galleryFiles.forEach(file => {
                    if (file.size > 0) {
                        console.log('üñºÔ∏è Nova imagem da galeria detectada');
                        newFiles.push({file: file, type: 'gallery'});
                    }
                });
            }

            console.log('üìÅ Total de novos arquivos:', newFiles.length);

            if (newFiles.length > 0) {
                // USAR PROMISE.ALL PARA PROCESSAR TODAS AS IMAGENS DE UMA VEZ
                const imagePromises = newFiles.map(({file, type}) => {
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            resolve({
                                data: e.target.result,
                                type: type
                            });
                        };
                        reader.onerror = function(error) {
                            console.error('‚ùå Erro ao ler arquivo:', error);
                            reject(error);
                        };
                        reader.readAsDataURL(file);
                    });
                });

                Promise.all(imagePromises)
                    .then(results => {
                        console.log('üìä Todas as imagens processadas:', results.length);
                        
                        // Processar resultados em ordem
                        results.forEach(({data, type}) => {
                            if (type === 'thumbnail') {
                                // Substituir primeira imagem ou adicionar como primeira
                                if (updatedProperty.images.length > 0) {
                                    updatedProperty.images[0] = data;
                                    console.log('üîÑ Thumbnail substitu√≠da');
                                } else {
                                    updatedProperty.images.unshift(data);
                                    console.log('‚ûï Thumbnail adicionada como primeira');
                                }
                            } else {
                                // Adicionar √† galeria se n√£o exceder limite
                                if (updatedProperty.images.length < 12) {
                                    updatedProperty.images.push(data);
                                    console.log('‚ûï Imagem adicionada √† galeria');
                                } else {
                                    console.log('‚ö†Ô∏è Limite de 12 imagens atingido');
                                }
                            }
                        });
                        
                        saveUpdatedProperty();
                    })
                    .catch(error => {
                        console.error('‚ùå Erro ao processar imagens:', error);
                        alert('‚ùå Erro ao processar as imagens. Tente novamente.');
                    });
            } else {
                console.log('üíæ Salvando apenas altera√ß√µes de texto');
                saveUpdatedProperty();
            }

            function saveUpdatedProperty() {
                try {
                    console.log('üíæ SALVANDO PROPRIEDADE ATUALIZADA');
                    console.log('üìä Total final de imagens:', updatedProperty.images.length);
                    
                    // Substituir o im√≥vel no array
                    properties[propertyIndex] = updatedProperty;
                    
                    // Salvar no localStorage com verifica√ß√£o
                    try {
                        localStorage.setItem('properties', JSON.stringify(properties));
                        console.log('‚úÖ Salvo no localStorage');
                    } catch (storageError) {
                        console.error('‚ùå Erro no localStorage:', storageError);
                        throw new Error('Erro ao salvar no navegador. Talvez as imagens sejam muito grandes.');
                    }
                    
                    // Limpar campos de arquivo ANTES de atualizar displays
                    const thumbnailInput = form.querySelector('input[name="thumbnailImage"]');
                    const galleryInput = form.querySelector('input[name="galleryImages"]');
                    if (thumbnailInput) {
                        thumbnailInput.value = '';
                        console.log('üßπ Campo thumbnail limpo');
                    }
                    if (galleryInput) {
                        galleryInput.value = '';
                        console.log('üßπ Campo galeria limpo');
                    }
                    
                    // Esconder previews
                    document.getElementById('thumbnailPreview').classList.add('hidden');
                    document.getElementById('galleryPreview').classList.add('hidden');
                    console.log('üßπ Previews escondidos');
                    
                    // Usar setTimeout para garantir que a UI seja atualizada
                    setTimeout(() => {
                        loadProperties();
                        loadAdminProperties();
                        updateCurrentImagesDisplay(id);
                        console.log('üîÑ Todos os displays atualizados');
                        
                        console.log('‚úÖ ATUALIZA√á√ÉO CONCLU√çDA COM SUCESSO!');
                        alert('‚úÖ Im√≥vel atualizado com sucesso!');
                    }, 100);
                    
                } catch (error) {
                    console.error('‚ùå Erro ao salvar:', error);
                    alert(`‚ùå Erro ao salvar: ${error.message}`);
                }
            }
        }

        function duplicateProperty(id) {
            console.log('üìã INICIANDO DUPLICA√á√ÉO - ID:', id);
            
            const property = properties.find(p => p.id === id);
            if (!property) {
                console.error('‚ùå Propriedade n√£o encontrada para duplica√ß√£o');
                return;
            }

            console.log('üìù Propriedade encontrada:', property.title);

            const duplicatedProperty = {
                ...property,
                id: Date.now(),
                title: property.title + ' - C√≥pia',
                featured: false, // NUNCA duplicar como destaque
                images: [...(property.images || [])] // Clone the images array
            };

            console.log('üìã Propriedade duplicada criada:', duplicatedProperty.title);
            console.log('‚≠ê Destaque (deve ser false):', duplicatedProperty.featured);

            properties.push(duplicatedProperty);
            localStorage.setItem('properties', JSON.stringify(properties));
            
            console.log('üíæ Propriedade duplicada salva');
            console.log('üìä Total de im√≥veis:', properties.length);
            
            loadProperties();
            loadAdminProperties();
            
            console.log('‚úÖ DUPLICA√á√ÉO CONCLU√çDA COM SUCESSO!');
            alert('Im√≥vel duplicado com sucesso! Voc√™ pode edit√°-lo para fazer as altera√ß√µes necess√°rias.');
        }

        function deleteProperty(id) {
            if (confirm('Tem certeza que deseja excluir este im√≥vel?')) {
                properties = properties.filter(p => p.id !== id);
                localStorage.setItem('properties', JSON.stringify(properties));
                loadProperties();
                loadAdminProperties();
            }
        }

        function recoverPassword() {
            const email = prompt('Digite seu email para recupera√ß√£o de senha:');
            if (email) {
                // Simular envio de email
                alert(`Um email com instru√ß√µes foi enviado para: ${email}\n\nPara demonstra√ß√£o, a senha atual √©: ${ADMIN_PASSWORD}\n\nEm um sistema real, isso seria enviado por email.`);
            }
        }

        // Contact and interaction functions
        function scheduleVisit() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Lead');
            }
            if (typeof gtag !== 'undefined') {
                gtag('event', 'generate_lead', {
                    'event_category': 'engagement'
                });
            }
            
            window.open('https://wa.me/5511999999999?text=Ol√° Marcio! Gostaria de agendar uma visita para este im√≥vel.', '_blank');
        }

        function requestInfo() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Lead');
            }
            if (typeof gtag !== 'undefined') {
                gtag('event', 'generate_lead', {
                    'event_category': 'engagement'
                });
            }
            
            window.open('https://wa.me/5511999999999?text=Ol√° Marcio! Gostaria de mais informa√ß√µes sobre este im√≥vel.', '_blank');
        }

        function submitContact(event) {
            event.preventDefault();
            
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Contact');
            }
            if (typeof gtag !== 'undefined') {
                gtag('event', 'contact', {
                    'event_category': 'engagement'
                });
            }
            
            alert('Mensagem enviada com sucesso! Marcio entrar√° em contato em breve.');
            event.target.reset();
        }

        function trackWhatsAppClick() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Contact');
            }
            if (typeof gtag !== 'undefined') {
                gtag('event', 'whatsapp_click', {
                    'event_category': 'engagement'
                });
            }
        }

        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Close modals when clicking outside
        document.getElementById('propertyModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        document.getElementById('adminLoginModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAdminLogin();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96f4d7f722b44b4c',t:'MTc1NTIyMDU1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
